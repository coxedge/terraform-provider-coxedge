---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "coxedge_waf_settings Resource - terraform-provider-coxedge"
subcategory: ""
description: WAF Settings for a site in a given environment.
  
---

# coxedge_waf_settings (Resource)
WAF Settings for a site in a given environment.

Example Usage
---
```
terraform {
  required_providers {
    coxedge = {
      version = "0.4.6"
      source  = "coxedge/coxedge"
    
  }
}

provider "coxedge" {
  key = "[INSERT API KEY HERE]"
}

#do import existing resource, do run below script
#terraform import coxedge_waf_settings.testing site_id:environment_name:organization_id

resource "coxedge_waf_settings" "testing" {
  organization_id         = "organization_id"
  site_id                 = "site_id"
  environment_name        = "environment_name"
  domain                  = "www.coxedge.com"
  monitoring_mode_enabled = "false"
  api_urls                = [
    "/test/this/ways123"
  ]
  ddos_settings {
    burst_threshold           = 110
    global_threshold          = 500
    subsecond_burst_threshold = 50
  }
  owasp_threats {
    apache_struts_exploit                  = "true"
    code_injection                         = "false"
    common_web_application_vulnerabilities = "false"
    csrf                                   = "true"
    local_file_inclusion                   = "false"
    open_redirect                          = "false"
    personal_identifiable_info             = "false"
    protocol_attack                        = "true"
    remote_file_inclusion                  = "false"
    sensitive_data_exposure                = "true"
    serverside_template_injection          = "true"
    shell_injection                        = "false"
    shell_shock_attack                     = "false"
    sql_injection                          = "false"
    webshell_execution_attempt             = "false"
    xml_external_entity                    = "true"
    xss_attack                             = "false"
  }
  general_policies {
    block_invalid_user_agents = "true"
    block_unknown_user_agents = "true"
    http_method_validation    = "false"
  }
  traffic_sources {
    convicted_bot_traffic              = "true"
    external_reputation_block_list     = "false"
    traffic_from_suspicious_nat_ranges = "false"
    traffic_via_cdn                    = "false"
    via_hosting_services               = "false"
    via_proxy_networks                 = "false"
    via_tor_nodes                      = "false"
    via_vpn                            = "true"
  }
  anti_automation_bot_protection {
    anti_scraping                                 = "true"
    challenge_automated_clients                   = "false"
    challenge_headless_browsers                   = "false"
    force_browser_validation_on_traffic_anomalies = "true"
  }
  behavioral_waf {
    block_probing_and_forced_browsing         = "false"
    bruteforce_protection                     = "true"
    obfuscated_attacks_and_zeroday_mitigation = "true"
    repeated_violations                       = "true"
    spam_protection                           = "true"
  }
  cms_protection {
    whitelist_drupal      = "false"
    whitelist_joomla      = "false"
    whitelist_magento     = "false"
    whitelist_modx        = "false"
    whitelist_origin_ip   = "false"
    whitelist_umbraco     = "false"
    whitelist_wordpress   = "false"
    wordpress_waf_ruleset = "true"
  }
  allow_known_bots {
    acquia_uptime                         = "false"
    add_search_bot                        = "false"
    adestra_bot                           = "false"
    adjust_servers                        = "false"
    ahrefs_bot                            = "false"
    alerta_bot                            = "false"
    alexa_ia_archiver                     = "true"
    alexa_technologies                    = "true"
    amazon_route_53_health_check_service  = "false"
    apple_news_bot                        = "false"
    applebot                              = "true"
    ask_jeeves_bot                        = "true"
    audisto_bot                           = "false"
    baidu_spider_bot                      = "true"
    baidu_spider_japan_bot                = "true"
    binary_canary                         = "false"
    bitbucket_webhook                     = "false"
    blekko_scout_jet_bot                  = "true"
    chrome_compression_proxy              = "true"
    coccocbot                             = "false"
    cookie_bot                            = "false"
    cybersource                           = "false"
    daumoa_bot                            = "true"
    detectify_scanner                     = "false"
    digi_cert_dcv_bot                     = "false"
    dotmic_dot_bot_commercial             = "false"
    duck_duck_go_bot                      = "false"
    facebook_external_hit_bot             = "true"
    feed_press                            = "false"
    feed_wind                             = "false"
    feeder_co                             = "false"
    freshping_monitoring                  = "false"
    geckoboard                            = "false"
    ghost_inspector                       = "false"
    gomez                                 = "false"
    goo_japan_bot                         = "true"
    google_ads_bot                        = "true"
    google_bot                            = "true"
    google_cloud_monitoring_bot           = "false"
    google_feed_fetcher_bot               = "true"
    google_image_bot                      = "true"
    google_image_proxy                    = "true"
    google_mediapartners_bot              = "true"
    google_mobile_ads_bot                 = "true"
    google_news_bot                       = "true"
    google_page_speed_insights            = "true"
    google_structured_data_testing_tool   = "true"
    google_verification_bot               = "true"
    google_video_bot                      = "true"
    google_web_light                      = "true"
    grapeshot_bot_commercial              = "false"
    gree_japan_bot                        = "true"
    hetrix_tools                          = "false"
    hi_pay                                = "true"
    hyperspin_bot                         = "false"
    ias_crawler_commercial                = "false"
    internet_archive_bot                  = "true"
    j_word_japan_bot                      = "true"
    jetpack_bot                           = "false"
    jike_spider_bot                       = "true"
    kakao_user_agent                      = "false"
    kyoto_tohoku_crawler                  = "false"
    landau_media_spider                   = "false"
    lets_encrypt                          = "false"
    line_japan_bot                        = "true"
    linked_in_bot                         = "true"
    livedoor_japan_bot                    = "false"
    mail_ru_bot                           = "false"
    manage_wp                             = "false"
    microsoft_bing_bot                    = "true"
    microsoft_bing_preview_bot            = "true"
    microsoft_msn_bot                     = "true"
    microsoft_skype_bot                   = "true"
    mixi_japan_bot                        = "true"
    mobage_japan_bot                      = "true"
    naver_yeti_bot                        = "true"
    new_relic_bot                         = "true"
    ocn_japan_bot                         = "true"
    panopta_bot                           = "false"
    parse_ly_scraper                      = "false"
    pay_pal_ipn                           = "true"
    petal_bot                             = "false"
    pingdom                               = "true"
    pinterest_bot                         = "false"
    qwantify_bot                          = "false"
    roger_bot                             = "false"
    sage_pay                              = "false"
    sectigo_bot                           = "false"
    semrush_bot                           = "false"
    server_density_service_monitoring_bot = "true"
    seznam_bot                            = "true"
    shareaholic_bot                       = "false"
    site_24_x_7_bot                       = "false"
    site_lock_spider                      = "true"
    siteimprove_bot                       = "false"
    slack_bot                             = "true"
    sogou_bot                             = "true"
    soso_spider_bot                       = "true"
    spatineo                              = "false"
    spring_bot                            = "false"
    stackify                              = "false"
    status_cake_bot                       = "false"
    stripe                                = "false"
    sucuri_uptime_monitor_bot             = "false"
    telegram_bot                          = "false"
    testomato_bot                         = "false"
    the_find_crawler                      = "false"
    twitter_bot                           = "true"
    uptime_robot                          = "false"
    vkontakte_external_hit_bot            = "true"
    w_3_c                                 = "false"
    wordfence_central                     = "false"
    workato                               = "false"
    xml_sitemaps                          = "false"
    yahoo_inktomi_slurp_bot               = "true"
    yahoo_japan_bot                       = "true"
    yahoo_link_preview                    = "true"
    yahoo_seeker_bot                      = "true"
    yahoo_slurp_bot                       = "true"
    yandex_bot                            = "true"
    yisou_spider_commercial               = "false"
    yodao_bot                             = "true"
    zendesk_bot                           = "false"
    zoho_bot                              = "false"
    zum_bot                               = "false"
  }
  
  timeouts {
    update = "20m"
  }
}
```


<!-- schema generated by tfplugindocs -->
## Argument Reference
The following arguments are supported:

### Required

- `environment_name` (String) - Name of the environment belonging to the organization.
- `organization_id` (String) - The id of the organization.
- `site_id` (String) - The ID of the site that the WAF belongs to.

### Optional

- `allow_known_bots` (Block List) (see [below for nested schema](#nestedblock--allow_known_bots)) - An object containing known bots.
- `anti_automation_bot_protection` (Block List) (see [below for nested schema](#nestedblock--anti_automation_bot_protection)) - Block automated traffic from scanning and browsing your online application.
- `api_urls` (List of String) - List of configured API urls.
- `behavioral_waf` (Block List) (see [below for nested schema](#nestedblock--behavioral_waf)) - Cox's sophisticated user behaviour and reputation analysis rules
- `cms_protection` (Block List) (see [below for nested schema](#nestedblock--cms_protection)) - Whitelist admin users.
- `ddos_settings` (Block List) (see [below for nested schema](#nestedblock--ddos_settings)) - The DDoS Setting containing the different threshold values.
- `domain` (String) - The domain of the site.
- `general_policies` (Block List) (see [below for nested schema](#nestedblock--general_policies))
- `monitoring_mode_enabled` (String) - If the monitoring mode is enabled.
- `owasp_threats` (Block List) (see [below for nested schema](#nestedblock--owasp_threats)) - Cox’s core rule set & OWASP’s most critical Web application security risks
- `traffic_sources` (Block List) (see [below for nested schema](#nestedblock--traffic_sources)) - Real-time threat intelligence for IP addresses, source location, and information on malicious IPs.
- `timeouts` (Block List, Min: 1) - Can pass custom timeout while update. Example: update = "20m"

### Read-Only

- `id` (String) - The ID of this resource.
- `stack_id` (String) - The ID of the stack that a site belongs to.

<a id="nestedblock--allow_known_bots"></a>
### Nested Schema for `allow_known_bots`

Optional:

- `acquia_uptime` (String)
- `add_search_bot` (String)
- `adestra_bot` (String)
- `adjust_servers` (String)
- `ahrefs_bot` (String)
- `alerta_bot` (String)
- `alexa_ia_archiver` (String)
- `alexa_technologies` (String)
- `amazon_route_53_health_check_service` (String)
- `apple_news_bot` (String)
- `applebot` (String)
- `ask_jeeves_bot` (String)
- `audisto_bot` (String)
- `baidu_spider_bot` (String)
- `baidu_spider_japan_bot` (String)
- `binary_canary` (String)
- `bitbucket_webhook` (String)
- `blekko_scout_jet_bot` (String)
- `chrome_compression_proxy` (String)
- `coccocbot` (String)
- `cookie_bot` (String)
- `cybersource` (String)
- `daumoa_bot` (String)
- `detectify_scanner` (String)
- `digi_cert_dcv_bot` (String)
- `dotmic_dot_bot_commercial` (String)
- `duck_duck_go_bot` (String)
- `facebook_external_hit_bot` (String)
- `feed_press` (String)
- `feed_wind` (String)
- `feeder_co` (String)
- `freshping_monitoring` (String)
- `geckoboard` (String)
- `ghost_inspector` (String)
- `gomez` (String)
- `goo_japan_bot` (String)
- `google_ads_bot` (String)
- `google_bot` (String)
- `google_cloud_monitoring_bot` (String)
- `google_feed_fetcher_bot` (String)
- `google_image_bot` (String)
- `google_image_proxy` (String)
- `google_mediapartners_bot` (String)
- `google_mobile_ads_bot` (String)
- `google_news_bot` (String)
- `google_page_speed_insights` (String)
- `google_structured_data_testing_tool` (String)
- `google_verification_bot` (String)
- `google_video_bot` (String)
- `google_web_light` (String)
- `grapeshot_bot_commercial` (String)
- `gree_japan_bot` (String)
- `hetrix_tools` (String)
- `hi_pay` (String)
- `hyperspin_bot` (String)
- `ias_crawler_commercial` (String)
- `internet_archive_bot` (String)
- `j_word_japan_bot` (String)
- `jetpack_bot` (String)
- `jike_spider_bot` (String)
- `kakao_user_agent` (String)
- `kyoto_tohoku_crawler` (String)
- `landau_media_spider` (String)
- `lets_encrypt` (String)
- `line_japan_bot` (String)
- `linked_in_bot` (String)
- `livedoor_japan_bot` (String)
- `mail_ru_bot` (String)
- `manage_wp` (String)
- `microsoft_bing_bot` (String)
- `microsoft_bing_preview_bot` (String)
- `microsoft_msn_bot` (String)
- `microsoft_skype_bot` (String)
- `mixi_japan_bot` (String)
- `mobage_japan_bot` (String)
- `naver_yeti_bot` (String)
- `new_relic_bot` (String)
- `ocn_japan_bot` (String)
- `panopta_bot` (String)
- `parse_ly_scraper` (String)
- `pay_pal_ipn` (String)
- `petal_bot` (String)
- `pingdom` (String)
- `pinterest_bot` (String)
- `qwantify_bot` (String)
- `roger_bot` (String)
- `sage_pay` (String)
- `sectigo_bot` (String)
- `semrush_bot` (String)
- `server_density_service_monitoring_bot` (String)
- `seznam_bot` (String)
- `shareaholic_bot` (String)
- `site_24_x_7_bot` (String)
- `site_lock_spider` (String)
- `siteimprove_bot` (String)
- `slack_bot` (String)
- `sogou_bot` (String)
- `soso_spider_bot` (String)
- `spatineo` (String)
- `spring_bot` (String)
- `stackify` (String)
- `status_cake_bot` (String)
- `stripe` (String)
- `sucuri_uptime_monitor_bot` (String)
- `telegram_bot` (String)
- `testomato_bot` (String)
- `the_find_crawler` (String)
- `twitter_bot` (String)
- `uptime_robot` (String)
- `vkontakte_external_hit_bot` (String)
- `w_3_c` (String)
- `wordfence_central` (String)
- `workato` (String)
- `xml_sitemaps` (String)
- `yahoo_inktomi_slurp_bot` (String)
- `yahoo_japan_bot` (String)
- `yahoo_link_preview` (String)
- `yahoo_seeker_bot` (String)
- `yahoo_slurp_bot` (String)
- `yandex_bot` (String)
- `yisou_spider_commercial` (String)
- `yodao_bot` (String)
- `zendesk_bot` (String)
- `zoho_bot` (String)
- `zum_bot` (String)


<a id="nestedblock--anti_automation_bot_protection"></a>
### Nested Schema for `anti_automation_bot_protection`

Optional:

- `anti_scraping` (String)
- `challenge_automated_clients` (String)
- `challenge_headless_browsers` (String)
- `force_browser_validation_on_traffic_anomalies` (String)


<a id="nestedblock--behavioral_waf"></a>
### Nested Schema for `behavioral_waf`

Optional:

- `block_probing_and_forced_browsing` (String) - Challenge or block sessions and users that seem to make brute-forced requests on random URLs seeking to discover a Web application's structure and hidden directories.
- `bruteforce_protection` (String) - Challenge and block attempts seeking to guess user names and passwords on Web login forms.
- `obfuscated_attacks_and_zeroday_mitigation` (String) - Block clients performing multiple injection attacks.
- `repeated_violations` (String) - Challenge or block clients that failed to answer previous challenges.
- `spam_protection` (String) - Challenge and block user sessions and activities that seem to be aggressively using forms on your website to post spam content, generate new accounts, and more. Also, require a handshake (if not already provided) to clients making POST requests.


<a id="nestedblock--cms_protection"></a>
### Nested Schema for `cms_protection`

Optional:

- `whitelist_drupal` (String) - Enable whitelist Drupal admin logged-in users.
- `whitelist_joomla` (String) - Enable whitelist Joomla admin logged-in users.
- `whitelist_magento` (String) - Enable whitelist Magento admin logged-in users.
- `whitelist_modx` (String) - Enable whitelist MODX admin logged-in users.
- `whitelist_origin_ip` (String) - Enable this policy to whitelist requests coming from the origin for plugin updates and general CMS update.
- `whitelist_umbraco` (String) - Enable whitelist Umbraco admin logged-in users.
- `whitelist_wordpress` (String) - Enable whitelist WordPress admin logged-in users.
- `wordpress_waf_ruleset` (String) - Enable a set of rules designed to block common Wordpress exploits.


<a id="nestedblock--ddos_settings"></a>
### Nested Schema for `ddos_settings`

Required:

- `burst_threshold` (Number) - The number of requests per two seconds that can trigger DDoS protection.
- `global_threshold` (Number) - The number of overall requests per ten seconds that can trigger DDoS protection.
- `subsecond_burst_threshold` (Number) - The number of requests per 0.1 seconds that can trigger DDoS protection.


<a id="nestedblock--general_policies"></a>
### Nested Schema for `general_policies`

Optional:

- `block_invalid_user_agents` (String) - Block requests in which the HTTP header describing the user-agent (browser and platform) seems invalid and cannot be translated to a known legitimate browser. Automated processes (bots) are most likely to have invalid user agents.
- `block_unknown_user_agents` (String) - Block requests in which the HTTP header describing the user-agent (browser and platform) is missing.
- `http_method_validation` (String)


<a id="nestedblock--owasp_threats"></a>
### Nested Schema for `owasp_threats`

Optional:

- `apache_struts_exploit` (String) - Patch known vulnerabilities in the Apache Struts framework by blocking requests suspected of exploiting these vulnerabilities.
- `code_injection` (String)
- `common_web_application_vulnerabilities` (String) - Block attempts to access and potentially harm your servers through common backdoors, such as common control panels, configuration scripts etc. which may be accessible to unwanted users.
- `csrf` (String)
- `local_file_inclusion` (String) - Block requests suspected of a Local File Inclusion attempt. Local File Inclusion attempts seek to exploit vulnerabilities in a Web application to execute potentially harmful scripts on your servers.
- `open_redirect` (String) - Block requests suspected of being an Open Redirect attempt. Open Redirect attempts to exploit vulnerabilities in a Web application to redirect a user to a new website without any validation of the target of redirect.
- `personal_identifiable_info` (String)
- `protocol_attack` (String)
- `remote_file_inclusion` (String) - Block requests suspected of being a Remote File Inclusion attempt. Remote File Inclusion attempts to exploit vulnerabilities in a Web application (typically in PHP) to execute a script from a 3rd party server. RFI attacks provide a backdoor for the hacker to change the behaviour of a server and Web application.
- `sensitive_data_exposure` (String)
- `serverside_template_injection` (String)
- `shell_injection` (String) - Block requests suspected of being a shell injection attack attempt. Shell Injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application. Command injection attacks are possible when an application passes unsafe user supplied data (forms, cookies, HTTP headers etc.) to a system shell.
- `shell_shock_attack` (String) - Block requests suspected of being a Shellshock attack attempt. A Shellshock attack is an attempt to exploit a server's vulnerabilities to gain full access and control over them. A successful attack would typically either abuse a server's resources or hack the website.
- `sql_injection` (String) -
- `webshell_execution_attempt` (String) - Block requests suspected of Web shell attempts. A Web shell is a script that can be uploaded to a Web server to enable remote administration of the machine. Infected Web servers can either be internet-facing or internal to the network, where the Web shell is used to further pivot to internal hosts.
- `xml_external_entity` (String)
- `xss_attack` (String) - Block requests suspected of being a Cross-Site-Scripting attack attempt. Cross Site Scripting attacks attempt to exploit vulnerabilities in a Web application and seek to inject a client side script either across an entire site or to a specific user's session. A successful attack would typically allow forbidden access to a user's actions and data.


<a id="nestedblock--traffic_sources"></a>
### Nested Schema for `traffic_sources`

Optional:

- `convicted_bot_traffic` (String) - Challenge traffic from IP addresses that have been convicted of automated activities (bots) on this site or on others. These IP addresses are used by malicious automated agents while no legitimate traffic has been observed on them.
- `external_reputation_block_list` (String)
- `traffic_from_suspicious_nat_ranges` (String)
- `traffic_via_cdn` (String)
- `via_hosting_services` (String)
- `via_proxy_networks` (String)
- `via_tor_nodes` (String)
- `via_vpn` (String)


